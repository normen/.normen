# apple mail
set from             = "Normen Hansen <normenweb@mac.com>"
set folder           = "imaps://imap.mail.me.com:993/"
set spoolfile        = "+INBOX"
set postponed        = "+Drafts"
set record           = "+Sent Messages"
set imap_user        = "normen"
set imap_pass        = "`security find-internet-password -gs IMAPSERVER -w`"
set smtp_url         = "smtp://$imap_user@smtp.mail.me.com:587"
set smtp_pass        = "`security find-internet-password -gs IMAPSERVER -w`"
set ssl_force_tls    = yes
set ssl_starttls     = yes
set ssl_use_sslv3=no
set ssl_use_tlsv1=no
set ssl_use_tlsv1_1=no
set ssl_use_tlsv1_2=yes
set ssl_verify_dates=yes
set ssl_verify_host=yes
set imap_pipeline_depth = 0
set smtp_authenticators = 'gssapi:login'

set imap_check_subscribed = yes

mailboxes +INBOX
mailboxes +Bestellungen
mailboxes +News
mailboxes +Notifications
mailboxes +Server-Meldungen
mailboxes +Junk
mailboxes "+Sent Messages"

# basic options
set wait_key = no
set timeout = 3
set mail_check_stats
set mail_check=60
set delete
set thorough_search
unset confirmappend
#unset move
unset mark_old
unset beep_new

# compose view options
set envelope_from                    # which from?
#set edit_headers                     # show headers when composing
set fast_reply                       # skip to compose when replying
#set askcc                            # ask for CC:
#set fcc_attach                       # save attachments with the body
#set forward_format = "Fwd: %s"       # format of subject when forwarding
set forward_decode                   # decode when forwarding
#set attribution = "On %d, %n wrote:" # format of quoting header
set reply_to                         # reply to Reply to: field
set reverse_name                     # reply as whomever it was to
set include                          # include message in replies
set forward_quote                    # include message in forwards
set text_flowed
unset sig_dashes                     # no dashes before sig
unset mime_forward                   # forward attachments as part of body

# status bar, date format, finding stuff etc.
set status_chars = " *%A"
set status_format = "[ Folder: %f ] [%r%m messages%?n? (%n new)?%?d? (%d to delete)?%?t? (%t tagged)? ]%>─%?p?( %p postponed )?"
set date_format = "%d.%m.%Y %H:%M"
#set index_format = "[%Z] %?X?A&-? %D  %-20.20F  %s"
set index_format = "[%Z] %D  %-20.20F  %s"
set sort=reverse-threads
set sort_aux=date-received
set uncollapse_jump
set sort_re
#set reply_regexp = "^(([Rr][Ee]?(\[[0-9]+\])?: *)?(\[[^]]+\] *)?)*"
#set quote_regexp = "^( {0,4}[>|:#%]| {0,4}[a-z0-9]+[>|]+)+"
set send_charset = "utf-8:iso-8859-1:us-ascii"
set charset = "utf-8"

# Pager View Options
set pager_index_lines = 10
set pager_context = 3
set pager_stop
set menu_scroll
set tilde
unset markers

# Sidebar options
set sidebar_visible
#set sidebar_format = "%B%?F? [%F]?%* %?N?%N/?%S"
set sidebar_short_path
set sidebar_folder_indent
#set sidebar_width = 25
#set sidebar_divider_char = ' | '
#set sidebar_indent_string = '  ''

set sidebar_format = "%B %* [%?N?%N / ?%S]"
set sidebar_divider_char = ┃
set sidebar_width = 24
set status_on_top = yes

set header_cache = "~/.normen/.mutt/cache/headers"
set message_cachedir = "~/.normen/.mutt/cache/bodies"

set attach_save_dir = "~/Downloads/"

set query_command = "contacts '%s'"
set editor = "~/.normen/.mutt/bgedit-screen-tmux.sh vim"
set background_edit = yes

auto_view text/html                                      # view html automatically
#auto_view image/*
auto_view application/pdf
alternative_order text/plain text/enriched text/html     # save html for last

#------------------------------------------------------------
# Vi Key Bindings
#------------------------------------------------------------

#bind index H sidebar-first
#bind index L sidebar-open
#bind index K sidebar-prev
#bind index J sidebar-next

bind index,pager H sidebar-prev
bind index,pager L sidebar-next
bind index,pager <Return> sidebar-open

bind pager K previous-entry
bind pager J next-entry

bind attach,browser,pager,index ö enter-command

bind index l display-message
bind pager l view-attachments
bind attach l view-attach
bind attach,browser,pager h exit
bind index h first-entry

macro attach,browser,index,pager \Ce "|vim -R -c 'set filetype=mail|set noma' -\n"

# Moving around
bind attach,browser,index       g   noop
bind attach,browser,index       gg  first-entry
bind attach,browser,index       G   last-entry
bind pager                      g  noop
bind pager                      gg  top
bind pager                      G   bottom
bind pager                      k   previous-line
bind pager                      j   next-line

bind index,pager <Tab> next-unread-mailbox

macro pager gx "|extract_url\n"

# Scrolling
bind attach,browser,pager,index \CF next-page
bind attach,browser,pager,index \CB previous-page
bind attach,browser,pager,index \Cu half-up
bind attach,browser,pager,index \Cd half-down
#bind browser,pager              \Ce next-line
#bind browser,pager              \Cy previous-line
#bind index                      \Ce next-line
#bind index                      \Cy previous-line

bind pager,index                d   noop
bind pager,index                dd  delete-message

# Mail & Reply
bind index                      \Cm list-reply # Doesn't work currently

# Threads
bind browser,pager,index        N   search-opposite
bind pager,index                dT  delete-thread
bind pager,index                dt  delete-subthread
bind pager,index                gt  next-thread
bind pager,index                gT  previous-thread
bind index                      za  collapse-thread
bind index                      zA  collapse-all # Missing :folddisable/foldenable

# GRUVBOX
source ~/.normen/.mutt/gruvbox-shuber.muttrc
source ~/.normen/.mutt/gruvbox-shuber-extended.muttrc
