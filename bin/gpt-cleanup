#!/bin/bash
set -e
secret_key=$(cat ~/.config/openaiapirc | sed -n -e 's/^secret_key *= *\(.*\)$/\1/p')
jq -sR '{
"model": "text-davinci-edit-001",
"input": .,
"instruction": "Clean up this code and annotate it.",
"temperature": 0
}'| \
  curl -s https://api.openai.com/v1/edits \
    -H "Content-Type: application/json" \
    -H "Authorization: Bearer ${secret_key}" \
    -d @- |\
  jq -r '.choices[0].text'
