#!/bin/bash
#OPENAI_API_KEY=$(cat ~/.config/openaiapirc | sed -n -e 's/^secret_key *= *\(.*\)$/\1/p') ~/.normen/bin/codex-universal.py $*
set -e
secret_key=$(cat ~/.config/openaiapirc | sed -n -e 's/^secret_key *= *\(.*\)$/\1/p')
jq -sR '{ "model": "text-davinci-edit-001", "input": ., "instruction": "Complete this skeleton code to fully functioning code with annotations." }'| \
  curl -s https://api.openai.com/v1/edits \
    -H "Content-Type: application/json" \
    -H "Authorization: Bearer ${secret_key}" \
    -d @- |\
  jq -r '.choices[0].text'
